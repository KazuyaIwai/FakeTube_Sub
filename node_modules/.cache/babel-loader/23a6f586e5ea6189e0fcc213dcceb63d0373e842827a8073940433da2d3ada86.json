{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\git\\\\FakeTube\\\\src\\\\views\\\\components\\\\templates\\\\HomeVideo.tsx\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport VideoList from '../molecules/VideoList';\nimport { makeStyles } from '@material-ui/core/styles';\nimport ApiFetch from '../../../utils/ApiFetch';\nimport HomeBadges from '../molecules/HomeBadges';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  headerMargin: {\n    backgroundColor: theme.palette.common.white\n  },\n  rootBadge: {\n    paddingTop: '10px',\n    paddingBottom: '10px',\n    backgroundColor: theme.palette.common.white\n  }\n}));\nconst HomeVideo = () => {\n  _s();\n  const classes = useStyles();\n  const {\n    fetchFtThumbnailVideos\n  } = ApiFetch;\n  const [isLoading, setIsLoading] = useState(false);\n  const [isEnd, setIsEnd] = useState(false);\n  const [hasMore, setHasMore] = useState(true);\n  const [data, setData] = useState([]);\n  const [page, setPage] = useState(0);\n  const loader = useRef(null);\n  const location = useLocation();\n  const [isInitFetch, setIsInitFetch] = useState(true);\n  const [canFetch, setCanFetch] = useState(true);\n  useEffect(() => {\n    const fetchVideoInfo = async () => {\n      try {\n        var limit = isInitFetch ? 6 : 1;\n        setIsLoading(true);\n        const newVideo = await fetchFtThumbnailVideos(limit, page, '');\n        setData(prev => [...prev, ...newVideo]);\n        setPage(prev => prev + limit);\n        if (isInitFetch) {\n          setIsInitFetch(false);\n        }\n        if (newVideo.length < limit) {\n          setCanFetch(false);\n        }\n      } catch (error) {\n        console.error(error);\n      }\n      setIsLoading(false);\n    };\n    const observer = new IntersectionObserver(_ref => {\n      let [entries] = _ref;\n      if (entries.isIntersecting && !isLoading && hasMore && canFetch) {\n        fetchVideoInfo();\n      }\n    }, {\n      threshold: 1\n    });\n    if (loader.current) {\n      observer.observe(loader.current);\n    }\n    return () => {\n      if (loader.current) {\n        observer.unobserve(loader.current);\n      }\n    };\n  }, [data, hasMore, isLoading]);\n  const path = \"\";\n  useEffect(() => {\n    if (location.pathname === path) {\n      setData([]);\n      setPage(1);\n      setIsEnd(false);\n      setHasMore(true);\n    }\n  }, [location.pathname, path]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.headerMargin,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.rootBadge,\n      children: /*#__PURE__*/_jsxDEV(HomeBadges, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(VideoList, {\n      videos: data\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: loader,\n      children: \" \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this);\n};\n_s(HomeVideo, \"04g8AiBTThDzj/hLwyUcOozHILA=\", false, function () {\n  return [useStyles, useLocation];\n});\n_c = HomeVideo;\nexport default HomeVideo;\nvar _c;\n$RefreshReg$(_c, \"HomeVideo\");","map":{"version":3,"names":["useState","useRef","useEffect","useLocation","VideoList","makeStyles","ApiFetch","HomeBadges","jsxDEV","_jsxDEV","useStyles","theme","headerMargin","backgroundColor","palette","common","white","rootBadge","paddingTop","paddingBottom","HomeVideo","_s","classes","fetchFtThumbnailVideos","isLoading","setIsLoading","isEnd","setIsEnd","hasMore","setHasMore","data","setData","page","setPage","loader","location","isInitFetch","setIsInitFetch","canFetch","setCanFetch","fetchVideoInfo","limit","newVideo","prev","length","error","console","observer","IntersectionObserver","_ref","entries","isIntersecting","threshold","current","observe","unobserve","path","pathname","className","children","fileName","_jsxFileName","lineNumber","columnNumber","videos","ref","_c","$RefreshReg$"],"sources":["C:/Users/user/git/FakeTube/src/views/components/templates/HomeVideo.tsx"],"sourcesContent":["import { useState, useRef, useEffect } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport VideoList from '../molecules/VideoList';\r\nimport { makeStyles, Theme } from '@material-ui/core/styles';\r\nimport ApiFetch from '../../../utils/ApiFetch';\r\nimport { FtThumbnailVideo } from '../../../utils/DataType';\r\nimport HomeBadges from '../molecules/HomeBadges';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  headerMargin: {\r\n    backgroundColor: theme.palette.common.white,\r\n  },\r\n  rootBadge: {\r\n    paddingTop: '10px',\r\n    paddingBottom: '10px',\r\n    backgroundColor: theme.palette.common.white,\r\n  },\r\n}));\r\n\r\nconst HomeVideo: React.FC = () => {\r\n  const classes = useStyles();\r\n\r\n  const { fetchFtThumbnailVideos } = ApiFetch;\r\n  const [isLoading, setIsLoading] = useState<boolean>(false);\r\n  const [isEnd, setIsEnd] = useState(false);\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [data, setData] = useState<FtThumbnailVideo[]>([]);\r\n  const [page, setPage] = useState<number>(0);\r\n  const loader = useRef<HTMLDivElement | null>(null);\r\n  const location = useLocation();\r\n  const [isInitFetch, setIsInitFetch] = useState<boolean>(true);\r\n  const [canFetch, setCanFetch] = useState<boolean>(true);\r\n\r\n  useEffect(() => {\r\n    const fetchVideoInfo = async () => {\r\n      try {\r\n        var limit = isInitFetch ? 6 : 1;\r\n        setIsLoading(true);\r\n        const newVideo = await fetchFtThumbnailVideos(limit, page, '');\r\n        setData((prev) => [...prev, ...newVideo]);\r\n        setPage((prev) => prev + limit);\r\n        if (isInitFetch) { setIsInitFetch(false); }\r\n        if (newVideo.length < limit) { setCanFetch(false); }\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n      setIsLoading(false);\r\n    };\r\n    const observer = new IntersectionObserver(([entries]) => {\r\n      if (entries.isIntersecting && !isLoading && hasMore && canFetch) {\r\n        fetchVideoInfo();\r\n      }\r\n    }, { threshold: 1 });\r\n\r\n    if (loader.current) {\r\n      observer.observe(loader.current);\r\n    }\r\n    return () => {\r\n      if (loader.current) {\r\n        observer.unobserve(loader.current);\r\n      }\r\n    };\r\n  }, [data, hasMore, isLoading]);\r\n\r\n  const path = \"\";\r\n  useEffect(() => {\r\n    if (location.pathname === path) {\r\n      setData([]);\r\n      setPage(1);\r\n      setIsEnd(false);\r\n      setHasMore(true);\r\n    }\r\n  }, [location.pathname, path]);\r\n\r\n  return (\r\n    <div className={classes.headerMargin}>\r\n      <div className={classes.rootBadge}>\r\n        <HomeBadges />\r\n      </div>\r\n      <VideoList videos={ data } />\r\n      <div ref={loader}> </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default HomeVideo;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}